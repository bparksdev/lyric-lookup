<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Genius Lyrics Search</title>
    
    <!-- Latest Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body class="container mt-5">
    <h1 class="text-center mb-4">Genius Lyrics Search</h1>
    
    <div class="mb-3">
        <input type="text" id="songInput" class="form-control" placeholder="Enter song name">
    </div>
    
    <div class="mb-3">
        <input type="text" id="artistInput" class="form-control" placeholder="Enter artist name">
    </div>
    
    <button onclick="searchGenius()" class="btn btn-primary mb-4">Search</button>
    <button onclick="resetForm()" class="btn btn-secondary mb-4">Reset</button>
    
    <div id="results" class="mt-3"></div>

    <script>
        function searchGenius() {
            let song = $("#songInput").val().trim();
            let artist = $("#artistInput").val().trim();

            if (!song || !artist) {
                $("#results").html("<p class='text-danger'>Please enter both a song name and an artist.</p>");
                return;
            }

            let baseURL = window.location.hostname.includes("localhost") 
                ? "http://localhost:8888/.netlify/functions/search"
                : "https://genius-lyrics.netlify.app/.netlify/functions/search";

            $.get(`${baseURL}?q=${song}`, function(response) {
                if (response.title) {
                    $("#results").html(`
                        <div class="card p-3">
                            <h2>${response.title}</h2>
                            <p><strong>Artist:</strong> ${response.artist}</p>
                            <p><a href="${response.url}" class="btn btn-success" target="_blank">View on Genius</a></p>
                        </div>
                    `);
                } else {
                    $("#results").html("<p class='text-danger'>No matching song found.</p>");
                }
            }).fail(function() {
                $("#results").html("<p class='text-danger'>Error fetching data.</p>");
            });
        }

            let song = $("#songInput").val();
            let artist = $("#artistInput").val();
            if (!song || !artist) {
                $("#results").html("<p class='text-danger'>Please enter both a song name and an artist.</p>");
                return;
            }
            
    // Detect if running on localhost or hosted on Netlify
            let baseURL = window.location.hostname.includes("localhost") 
                ? "http://localhost:3000/search" 
                : "https://genius-lyrics.netlify.app/search";

            $.get(`${baseURL}?q=${song}`, function(response) {
                if (response.response.hits.length > 0) {
                    let filteredResult = response.response.hits.find(hit => 
                        hit.result.primary_artist.name.toLowerCase() === artist.toLowerCase()
                    );

                    if (filteredResult) {
                        $("#results").html(`
                            <div class="card p-3">
                                <h2>${filteredResult.result.full_title}</h2>
                                <p><strong>Artist:</strong> ${filteredResult.result.primary_artist.name}</p>
                                <p><a href="${filteredResult.result.url}" class="btn btn-success" target="_blank">View on Genius</a></p>
                            </div>
                        `);
                    } else {
                        $("#results").html("<p class='text-danger'>No matching song found for the specified artist.</p>");
                    }
                } else {
                    $("#results").html("<p class='text-warning'>No results found.</p>");
                }
            }).fail(function() {
                $("#results").html("<p class='text-danger'>Error fetching data.</p>");
            });
        }

       function resetForm() {
            $("#songInput").val("");
            $("#artistInput").val("");
            $("#results").html(""); // Clears results
        }        
    </script>

    <!-- Latest Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
